<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.25.6"/><meta name="description" content="최후의 방어전선 구축하기" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta name="twitter:title" content="ErrorBoundary로 우아하게 에러 처리하기 - Eunsonny&#x27;s Blog" data-gatsby-head="true"/><meta name="twitter:description" content="최후의 방어전선 구축하기" data-gatsby-head="true"/><meta name="og:title" content="ErrorBoundary로 우아하게 에러 처리하기 - Eunsonny&#x27;s Blog" data-gatsby-head="true"/><meta name="og:type" content="website" data-gatsby-head="true"/><meta name="og:description" content="최후의 방어전선 구축하기" data-gatsby-head="true"/><meta name="theme-color" content="hsl(31, 92%, 62%)"/><style data-href="/styles.6ad3fa705a05818e873b.css" data-identity="gatsby-global-css">@import url(https://fonts.googleapis.com/css2?family=Fira+Code&display=swap);@font-face{font-display:var(--fontsource-display,swap);font-family:Oxygen Mono;font-style:normal;font-weight:400;src:url(/static/oxygen-mono-latin-ext-400-normal-275d4df6c91418ae1903028c19c95fb6.woff2) format("woff2"),url(/static/oxygen-mono-latin-ext-400-normal-9f82795cef2c82002ba709898acea384.woff) format("woff");unicode-range:u+0100-02af,u+0300-0301,u+0303-0304,u+0308-0309,u+0323,u+0329,u+1e??,u+2020,u+20a0-20ab,u+20ad-20cf,u+2113,u+2c60-2c7f,u+a720-a7ff}@font-face{font-display:var(--fontsource-display,swap);font-family:Oxygen Mono;font-style:normal;font-weight:400;src:url(/static/oxygen-mono-latin-400-normal-fcda75ae13b6af3dbf1c4b046d756f8f.woff2) format("woff2"),url(/static/oxygen-mono-latin-400-normal-c632619fe6d2c1466057220aafe6c044.woff) format("woff");unicode-range:u+00??,u+0131,u+0152-0153,u+02bb-02bc,u+02c6,u+02da,u+02dc,u+0300-0301,u+0303-0304,u+0308-0309,u+0323,u+0329,u+2000-206f,u+2074,u+20ac,u+2122,u+2191,u+2193,u+2212,u+2215,u+feff,u+fffd}:after,:before,:root{--color-white:#f6f1ea;--color-primary:#00b5f5;--color-secondary:#f7a145;--color-prism-background:#151718;--color-typographic-base-font:#212425;--color-typographic-link-p-font:#00b5f5;--color-typographic-link-s-font:#f7a145;--color-page-border:#dfcdb4;--color-page-background:#f6f1ea;--color-sidebar-border:#dfcdb4;--color-sidebar-border-fade:#f6f1ea;--color-contacts-border:#dfcdb4;--color-button-border:#dfcdb4;--color-button-color:#212425;--color-theme-switcher:#3f485a;--color-theme-switcher-hover:#00b5f5}.dark :after,.dark :before,:root.dark{--color-white:#f6f1ea;--color-primary:#00b5f5;--color-secondary:#f7a145;--color-prism-background:#151718;--color-typographic-base-font:#f6f1ea;--color-typographic-link-p-font:#00b5f5;--color-typographic-link-s-font:#f7a145;--color-page-border:#3f485a;--color-page-background:#212425;--color-sidebar-border:#3f485a;--color-sidebar-border-fade:#212425;--color-contacts-border:#3f485a;--color-button-border:#3f485a;--color-button-color:#f6f1ea;--color-theme-switcher:#dfcdb4;--color-theme-switcher-hover:#00b5f5}html{font-size:100}body{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;background:var(--color-page-background);color:var(--color-typographic-base-font);font-size:15px;line-height:1.625;margin:0 0 0 calc(100vw - 100%);text-rendering:optimizelegibility}body,h1,h2,h3,h4,h5,h6{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif}h1,h2,h3,h4,h5,h6{font-weight:600}h1{font-size:37.5px;line-height:52px;margin-bottom:26px;margin-top:104px}h2{font-size:25.3125px;line-height:39px}h2,h3{margin-bottom:13px;margin-top:52px}h3{font-size:20.625px;line-height:26px}h4{font-size:18px;margin-top:39px}h4,h5{line-height:26px;margin-bottom:13px}h5,h6{font-size:15px;margin-top:65px}h6{line-height:26px;margin-bottom:13px}img{max-width:100%}hr,img{border:0;display:block}hr{background-image:linear-gradient(180deg,transparent 1px,transparent 11px,#212425 0,#212425 15px,transparent 0,transparent 26px);background-size:100% 26px;color:var(--color-typographic-base-font);height:26px;margin:52px auto;width:100px}a{color:var(--color-typographic-link-p-font);text-decoration:none}a:active,a:focus,a:hover{color:var(--color-typographic-link-s-font)}b,strong{font-weight:800}ul{list-style:square;margin-bottom:26px;padding-left:52px}ul li{line-height:26px;margin-bottom:4px;padding:0 5px}p{margin-bottom:26px}blockquote{background-color:var(--color-prism-background);border-left:4px solid #00b5f5;font-style:italic;padding:12px 20px}blockquote p{margin:0}figure{display:block;height:auto;width:100%}figcaption{color:var(--color-typographic-base-font);font-size:14px;font-style:italic;line-height:19.5px;margin-bottom:0;margin-top:6.5px;text-align:center}@media screen and (min-width:685px){figure.float-left,figure.float-right{max-width:310px;padding:0 26px}.float-right{float:right}.float-left{float:left}}code[class*=language-],pre[class*=language-]{word-wrap:normal;color:#dbdee1;font-family:Oxygen Mono,Menlo,Monaco,Consolas,Andale Mono,Ubuntu Mono,Courier New,monospace;font-size:14px;font-weight:600;-webkit-hyphens:none;hyphens:none;letter-spacing:.01em;line-height:1.5;-o-tab-size:4;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{border-radius:.3em;margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:var(--color-prism-background)}:not(pre)>code[class*=language-]{border-radius:.4em;padding:.2em .4em}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{background:#073642}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#93a1a1}.token.punctuation{color:#dbdee1}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#a5d6ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string,.token.url{color:#79c0ff}.token.entity{background:#eee8d5;color:#657b83;cursor:help}.token.atrule,.token.attr-value,.token.keyword{color:#ff7b72}.token.class-name{color:#7ee787}.token.function{color:#d2a8ff}.token.important,.token.regex,.token.variable{color:#cb4b16}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.Feed-module--feed--a6204 .Feed-module--item--c7a63{margin-bottom:32.5px}.Feed-module--feed--a6204 .Feed-module--item--c7a63:last-child{margin-bottom:13px}.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--title--f252f{font-size:25.3125px;line-height:39px;margin-bottom:2.6px;margin-top:0}.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--title--f252f .Feed-module--link--6123b{color:var(--color-typographic-base-font)}.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--title--f252f .Feed-module--link--6123b:focus,.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--title--f252f .Feed-module--link--6123b:hover{border-bottom:1px solid #212425;color:var(--color-typographic-base-font)}.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--description--57348{font-size:15px;line-height:26px;margin-bottom:19.5px;margin-top:0}.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--meta--250c2 .Feed-module--time--72864{color:var(--color-typographic-base-font);font-size:14px;font-weight:600;text-transform:uppercase}.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--meta--250c2 .Feed-module--divider--81a18{margin:0 13px}.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--meta--250c2 .Feed-module--category--59f58 .Feed-module--link--6123b{color:var(--color-secondary);font-size:14px;font-weight:600;text-transform:uppercase}.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--meta--250c2 .Feed-module--category--59f58 .Feed-module--link--6123b:focus,.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--meta--250c2 .Feed-module--category--59f58 .Feed-module--link--6123b:hover{color:#00b5f5}.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--more--51a4e{color:var(--color-primary);font-size:15px}.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--more--51a4e:focus,.Feed-module--feed--a6204 .Feed-module--item--c7a63 .Feed-module--more--51a4e:hover{border-bottom:1px solid #00b5f5;color:var(--color-primary)}.Layout-module--layout--2c933{margin-left:auto;margin-right:auto;max-width:1070px}.Layout-module--layout--2c933:before{content:"";display:table}.Layout-module--layout--2c933:after{clear:both;content:"";display:table}.Page-module--page--24e03{margin-bottom:52px}.Page-module--page--24e03 .Page-module--inner--4b31d{padding:26px 19.5px 0}.Page-module--page--24e03 .Page-module--title--90338{font-size:37.5px;font-weight:600;line-height:52px;margin-bottom:37.7px;margin-top:0}.Page-module--page--24e03 .Page-module--body--561c4{font-size:15px;line-height:26px;margin:0 0 26px}@media screen and (min-width:685px){.Page-module--page--24e03{width:calc(58.275% - 12.5px)}.Page-module--page--24e03:nth-child(1n){clear:none;float:left;margin-right:30px}.Page-module--page--24e03:last-child{margin-right:0}.Page-module--page--24e03:nth-child(12n){float:right;margin-right:0}.Page-module--page--24e03:nth-child(12n+1){clear:both}.Page-module--page--24e03 .Page-module--inner--4b31d{padding:32.5px 19.5px 0}}@media screen and (min-width:960px){.Page-module--page--24e03{width:calc(66.6% - 10px)}.Page-module--page--24e03:nth-child(1n){clear:none;float:left;margin-right:30px}.Page-module--page--24e03:last-child{margin-right:0}.Page-module--page--24e03:nth-child(3n){float:right;margin-right:0}.Page-module--page--24e03:nth-child(3n+1){clear:both}.Page-module--page--24e03 .Page-module--inner--4b31d{padding:39px 26px 0}}.Pagination-module--pagination--d61cb{display:flex;margin-top:52px}.Pagination-module--pagination--d61cb .Pagination-module--previous--4a76b{text-align:left;width:50%}.Pagination-module--pagination--d61cb .Pagination-module--previous--4a76b .Pagination-module--previousLink--5590d{color:var(--color-secondary);font-size:26px;font-weight:700}.Pagination-module--pagination--d61cb .Pagination-module--previous--4a76b .Pagination-module--previousLink--5590d:focus,.Pagination-module--pagination--d61cb .Pagination-module--previous--4a76b .Pagination-module--previousLink--5590d:hover{color:var(--color-primary)}.Pagination-module--pagination--d61cb .Pagination-module--previous--4a76b .Pagination-module--previousLink--5590d.Pagination-module--disable--7e105{color:#3f485a;pointer-events:none}.Pagination-module--pagination--d61cb .Pagination-module--next--1cab8{text-align:right;width:50%}.Pagination-module--pagination--d61cb .Pagination-module--next--1cab8 .Pagination-module--nextLink--532ff{color:var(--color-secondary);font-size:26px;font-weight:700}.Pagination-module--pagination--d61cb .Pagination-module--next--1cab8 .Pagination-module--nextLink--532ff:focus,.Pagination-module--pagination--d61cb .Pagination-module--next--1cab8 .Pagination-module--nextLink--532ff:hover{color:var(--color-primary)}.Pagination-module--pagination--d61cb .Pagination-module--next--1cab8 .Pagination-module--nextLink--532ff.Pagination-module--disable--7e105{color:#3f485a;pointer-events:none}.Button-module--button--b1113{border:1px solid var(--color-button-border);border-radius:20px;color:var(--color-button-color);display:inline-block;font-size:15px;font-weight:400;height:40px;line-height:40px;margin-left:auto;margin-right:auto;padding:0 26px;text-align:center;text-decoration:none}.Button-module--button--b1113:focus,.Button-module--button--b1113:hover{color:#00b5f5}.ThemeSwitcher-module--themeSwitcher--8a77f{--color:var(--color-theme-switcher)}.ThemeSwitcher-module--themeSwitcher--8a77f .ThemeSwitcher-module--button--7cb7b{align-items:center;background:transparent;border:0;cursor:pointer;display:flex;justify-content:center;outline:0}.ThemeSwitcher-module--themeSwitcher--8a77f .ThemeSwitcher-module--button--7cb7b svg{stroke:var(--color);pointer-events:none;transition:stroke .4s}.ThemeSwitcher-module--themeSwitcher--8a77f .ThemeSwitcher-module--button--7cb7b:hover{--color:var(--color-theme-switcher-hover)}.ThemeSwitcher-module--themeSwitcher--8a77f .ThemeSwitcher-module--moon--10537{stroke-dasharray:0 1px;opacity:0;transition:stroke-dasharray .2s ease-in,opacity .4s ease-in}.ThemeSwitcher-module--themeSwitcher--8a77f .ThemeSwitcher-module--sun--2163a{stroke-dasharray:1px 1px;opacity:1;transition:stroke-dasharray .2s ease-in,opacity .4s ease-in}.ThemeSwitcher-module--themeSwitcher--8a77f.ThemeSwitcher-module--dark--6db0c .ThemeSwitcher-module--moon--10537{stroke-dasharray:1px 1px;opacity:1}.ThemeSwitcher-module--themeSwitcher--8a77f.ThemeSwitcher-module--dark--6db0c .ThemeSwitcher-module--sun--2163a{stroke-dasharray:0 1px;opacity:0}.Author-module--author--cbd31 .Author-module--photo--9787b{background-clip:padding-box;border-radius:50%;display:inline-block;height:75px;margin-bottom:0;width:75px}.Author-module--author--cbd31 .Author-module--photo--9787b img{border-radius:50%}.Author-module--author--cbd31 .Author-module--title--cf7e5{font-size:16.875px;font-weight:600;line-height:29.25px;margin:0}.Author-module--author--cbd31 .Author-module--title--cf7e5 .Author-module--link--09c17,.Author-module--author--cbd31 .Author-module--title--cf7e5 .Author-module--link--09c17:focus,.Author-module--author--cbd31 .Author-module--title--cf7e5 .Author-module--link--09c17:hover{color:var(--color-typographic-base-font)}.Author-module--author--cbd31 .Author-module--subtitle--86ec5{color:#7f8ba4;line-height:26px;margin-bottom:26px}.Author-module--author--cbd31 .Author-module--titleContainer--4f576{align-items:center;display:flex;justify-content:space-between;margin:13px 0}.Icon-module--icon--1d7da{fill:currentcolor;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;speak:none;stroke:currentcolor;stroke-width:0;display:inline-block;font-style:normal;font-variant:normal;font-weight:400;height:1em;line-height:1em;text-align:center;text-transform:none;width:1em}.Contacts-module--contacts--09178{margin-bottom:26px}.Contacts-module--contacts--09178 .Contacts-module--list--9670b{display:flex;flex-flow:row wrap;flex-grow:0;flex-shrink:0;list-style:none;margin:13px 0;max-width:165px;padding:0}.Contacts-module--contacts--09178 .Contacts-module--list--9670b .Contacts-module--item--f9cb0{align-content:center;align-items:center;border:1px solid var(--color-contacts-border);border-radius:50%;display:flex;height:40px;justify-content:center;line-height:40px;margin:6.5px;padding:0;text-align:center;width:40px}.Contacts-module--contacts--09178 .Contacts-module--list--9670b .Contacts-module--item--f9cb0:nth-child(3n+1){margin-left:0}.Contacts-module--contacts--09178 .Contacts-module--list--9670b .Contacts-module--item--f9cb0 .Contacts-module--link--de1e0{border:0;color:var(--color-typographic-base-font);cursor:pointer;display:flex}.Contacts-module--contacts--09178 .Contacts-module--list--9670b .Contacts-module--item--f9cb0 .Contacts-module--link--de1e0:focus,.Contacts-module--contacts--09178 .Contacts-module--list--9670b .Contacts-module--item--f9cb0 .Contacts-module--link--de1e0:hover{color:var(--color-typographic-link-p-font)}.Copyright-module--copyright--2c602{color:#7f8ba4;font-size:14px}.Menu-module--menu--113a9{margin-bottom:26px}.Menu-module--menu--113a9 .Menu-module--list--e1ae3{list-style:none;margin:0;padding:0}.Menu-module--menu--113a9 .Menu-module--list--e1ae3 .Menu-module--item--8b679{margin:13px 0;padding:0}.Menu-module--menu--113a9 .Menu-module--list--e1ae3 .Menu-module--item--8b679 .Menu-module--link--a6f02{border:0;color:var(--color-typographic-base-font);font-size:15px;font-weight:400}.Menu-module--menu--113a9 .Menu-module--list--e1ae3 .Menu-module--item--8b679 .Menu-module--link--a6f02:focus,.Menu-module--menu--113a9 .Menu-module--list--e1ae3 .Menu-module--item--8b679 .Menu-module--link--a6f02:hover{border-bottom:1px solid #00b5f5;color:#00b5f5}.Menu-module--menu--113a9 .Menu-module--list--e1ae3 .Menu-module--item--8b679 .Menu-module--link--a6f02.Menu-module--active--6cb74{border-bottom:1px solid var(--color-typographic-base-font);color:var(--color-typographic-base-font);font-weight:600}.Sidebar-module--sidebar--1bfa1{width:100%}.Sidebar-module--sidebar--1bfa1 .Sidebar-module--inner--344d0{padding:26px 19.5px 0;position:relative}.Sidebar-module--sidebar--1bfa1 .Sidebar-module--inner--344d0:after{background:var(--color-sidebar-border);background:linear-gradient(to bottom,var(--color-sidebar-border) 0,var(--color-sidebar-border) 48%,var(--color-sidebar-border-fade) 100%)}@media screen and (min-width:685px){.Sidebar-module--sidebar--1bfa1{width:calc(41.625% - 17.5px)}.Sidebar-module--sidebar--1bfa1:nth-child(1n){clear:none;float:left;margin-right:30px}.Sidebar-module--sidebar--1bfa1:last-child{margin-right:0}.Sidebar-module--sidebar--1bfa1:nth-child(12n){float:right;margin-right:0}.Sidebar-module--sidebar--1bfa1:nth-child(12n+1){clear:both}.Sidebar-module--sidebar--1bfa1 .Sidebar-module--inner--344d0{padding:32.5px 19.5px 0}.Sidebar-module--sidebar--1bfa1 .Sidebar-module--inner--344d0:after{bottom:0;content:"";height:540px;position:absolute;right:-10px;top:30px;width:1px}}@media screen and (min-width:960px){.Sidebar-module--sidebar--1bfa1{width:calc(33.3% - 20px)}.Sidebar-module--sidebar--1bfa1:nth-child(1n){clear:none;float:left;margin-right:30px}.Sidebar-module--sidebar--1bfa1:last-child{margin-right:0}.Sidebar-module--sidebar--1bfa1:nth-child(3n){float:right;margin-right:0}.Sidebar-module--sidebar--1bfa1:nth-child(3n+1){clear:both}.Sidebar-module--sidebar--1bfa1 .Sidebar-module--inner--344d0{padding:39px}}.Author-module--author--1c58d{border-top:1px solid var(--color-page-border);line-height:26px;margin-bottom:52px;margin-top:26px;max-width:800px;padding-top:26px}.Author-module--author--1c58d .Author-module--bio--08950 .Author-module--twitter--90647{display:block;text-decoration:underline}.Author-module--author--1c58d .Author-module--bio--08950 .Author-module--twitter--90647:focus,.Author-module--author--1c58d .Author-module--bio--08950 .Author-module--twitter--90647:hover{color:var(--color-typographic-link-s-font)}@media screen and (min-width:685px){.Author-module--author--1c58d{margin-left:auto;margin-right:auto}}.Content-module--content--80d58{margin:0 auto;max-width:945px;padding:0 13px}.Content-module--content--80d58 .Content-module--title--09504{font-size:30px;font-weight:600;line-height:42.9px;margin:26px auto 0;max-width:800px;text-align:center}.Content-module--content--80d58 .Content-module--body--726c2 figure{margin-bottom:26px}.Content-module--content--80d58 .Content-module--body--726c2 figure blockquote{font-style:italic;margin-top:0;padding:26px 0;text-align:center}.Content-module--content--80d58 .Content-module--body--726c2 figure blockquote p{font-size:25.2255px;line-height:39px;margin-top:0;max-width:800px}.Content-module--content--80d58 .Content-module--body--726c2 a{text-decoration:underline}.Content-module--content--80d58 .Content-module--body--726c2 *{margin-left:auto;margin-right:auto;max-width:800px}.Content-module--content--80d58 .Content-module--body--726c2 h2>a{visibility:hidden}.Content-module--content--80d58 .Content-module--body--726c2 h2>a>svg{fill:var(--color-typographic-base-font)}.Content-module--content--80d58 .Content-module--body--726c2 img{max-width:100%}@media screen and (min-width:960px){.Content-module--content--80d58{padding:0}.Content-module--content--80d58 .Content-module--title--09504{font-size:45px;line-height:58.5px;margin-bottom:39px;margin-top:58.5px}.Content-module--content--80d58 .Content-module--body--726c2,.Content-module--content--80d58 .Content-module--body--726c2 p{font-size:16.875px;line-height:29.25px;margin-bottom:29.25px}.Content-module--content--80d58 .Content-module--body--726c2 blockquote p{margin:0}.Content-module--content--80d58 .Content-module--body--726c2 h2>a{padding-right:13px;visibility:unset}}.Meta-module--meta--dae0a .Meta-module--date--4d30d{font-style:italic}.Tags-module--tags--18589{margin-bottom:13px}.Tags-module--tags--18589 .Tags-module--list--82ae6{list-style:none;padding:0}.Tags-module--tags--18589 .Tags-module--list--82ae6 .Tags-module--item--52015{display:inline-block;margin:6.5px 0}@media screen and (min-width:685px){.Tags-module--tags--18589 .Tags-module--list--82ae6 .Tags-module--item--52015:first-child{margin-left:0;padding-left:0}}.Post-module--post--3a994 .Post-module--content--3c6e5{margin:0 auto}.Post-module--post--3a994 .Post-module--comments--d3b99,.Post-module--post--3a994 .Post-module--footer--f8705{margin:0 auto;max-width:800px;padding:0 13px}.Post-module--post--3a994 .Post-module--buttons--2972d{align-items:center;display:flex;justify-content:center;margin:26px 0 0;text-align:center}.Post-module--post--3a994 .Post-module--buttons--2972d .Post-module--buttonArticles--d793a{margin:0 13px 0 0}@media screen and (min-width:960px){.Post-module--post--3a994 .Post-module--comments--d3b99,.Post-module--post--3a994 .Post-module--footer--f8705{padding:0}.Post-module--post--3a994 .Post-module--buttons--2972d{left:30px;margin:0 13px 0 0;max-width:none;position:fixed;top:30px}}</style><title data-gatsby-head="true">ErrorBoundary로 우아하게 에러 처리하기 - Eunsonny&#x27;s Blog</title><link rel="alternate" type="application/rss+xml" title="Eunsonny&#x27;s Blog" href="/rss.xml"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-73379983-2"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-73379983-2', {"send_page_view":false});
      }
      </script><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/><link rel="icon" href="/favicon-32x32.png?v=f3d825d4ed7aba0a74cde53886aebb16" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=f3d825d4ed7aba0a74cde53886aebb16"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=f3d825d4ed7aba0a74cde53886aebb16"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=f3d825d4ed7aba0a74cde53886aebb16"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=f3d825d4ed7aba0a74cde53886aebb16"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=f3d825d4ed7aba0a74cde53886aebb16"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=f3d825d4ed7aba0a74cde53886aebb16"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=f3d825d4ed7aba0a74cde53886aebb16"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=f3d825d4ed7aba0a74cde53886aebb16"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script></head><body><script>
          void function() {
            var cachedMode;

            try {
              var preferredTheme = JSON.parse(localStorage.getItem('diesel:theme-atom'));

              if (preferredTheme && preferredTheme.mode) {
                cachedMode = preferredTheme.mode;
              }
            } catch (err) { }

            function setTheme(newTheme) {
              document.documentElement.className = newTheme;
            }

            var darkQuery = window.matchMedia('(prefers-color-scheme: dark)');

            setTheme(cachedMode || (darkQuery.matches ? 'dark' : 'light'));
          }()
        </script><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="Layout-module--layout--2c933"><div class="Post-module--post--3a994"><div class="Post-module--buttons--2972d"><a class="Button-module--button--b1113 Post-module--buttonArticles--d793a" href="/">All Posts</a></div><div class="Post-module--content--3c6e5"><div class="Content-module--content--80d58"><h1 class="Content-module--title--09504">ErrorBoundary로 우아하게 에러 처리하기</h1><div class="Content-module--body--726c2"><h2 id="에러-바운더리란" style="position:relative;"><a href="#%EC%97%90%EB%9F%AC-%EB%B0%94%EC%9A%B4%EB%8D%94%EB%A6%AC%EB%9E%80" aria-label="에러 바운더리란 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>에러 바운더리란?</h2>
<p>에러 바운더리(Error Boundary)는 React에서 에러 처리를 담당하는 컴포넌트이다. 컴포넌트 트리의 일부를 격리하여 예기치 않은 에러로부터 애플리케이션을 보호하고 대체 UI를 렌더링할 수 있게 한다. 이를 통해 사용자 경험을 개선하고 애플리케이션 전체의 중단을 방지할 수 있다. 에러 바운더리는 React 16부터 도입되었으며, <strong><code class="language-text">componentDidCatch</code></strong> 메서드를 사용하여 에러 처리를 구현한다. 이를 활용하면 안정성과 유지 보수성을 향상시킬 수 있다.</p>
<p>단 에러 바운더리는 다음과 같은 에러는 캐치하지 못한다.</p>
<ul>
<li>이벤트 핸들러</li>
<li>비동기적 코드</li>
<li>서버 사이드 렌더링</li>
<li>자식이 아닌 에러 바운더리 자체에서 발생하는 에러</li>
</ul>
<h2 id="에러-바운더리를-사용하고자-한-이유" style="position:relative;"><a href="#%EC%97%90%EB%9F%AC-%EB%B0%94%EC%9A%B4%EB%8D%94%EB%A6%AC%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B3%A0%EC%9E%90-%ED%95%9C-%EC%9D%B4%EC%9C%A0" aria-label="에러 바운더리를 사용하고자 한 이유 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>에러 바운더리를 사용하고자 한 이유</h2>
<p>에러 바운더리를 사용함으로써 얻을 수 있는 이점에는 여러가지가 있지만 적극적으로 에러 바운더리를 사용하고자 한 가장 큰 이유는 <strong>에러 관리 포인트를 최소화</strong> 하고 싶었기 때문이다. 특히 본래의 ErrorBoundary는 데이터 페칭과 같은 비동기적 코드 에러를 캐치하지 못하지만 React Query의 defaultOptions에 <code class="language-text">useErrorBoundary:true</code> 를 사용함으로써 서버 통신과 관련한 비동기적 에러도 ErrorBoundary에서 함께 핸들링 할 수 있다는 점에서 (리액트 쿼리의 도입과 함께) 이 점을 적극 활용하여 중앙 집중식 에러 관리를 할 수 있겠다고 생각했다.</p>
<p>기존에는 아래의 코드와 같은 형태로 에러를 핸들링했다.</p>
<div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token comment">// start loading    </span>
    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> apiClient<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">get</span><span class="token generic class-name"><span class="token operator">&lt;</span>User<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">URL</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> response
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// handle error  }</span>
<span class="token punctuation">}</span></code></pre></div>
<p>모든 API 호출 함수마다 try-catch문으로 감싸 주었다. 이런 방식은 고전적인 방식(?)이기는 하지만 실수로 try-catch문을 빼먹을 수 있다는 휴먼에러 발생 가능성이 있다. 따라서 매번 try-catch 문으로 감싸주어야 하는 불편함과 휴먼에러의 위험성을 제거하고 중앙 집중식 에러 핸들링 하고자 하는 것이 목표였다.</p>
<p>만약 React Query와 같은 라이브러리를 쓰지 못하는 상황에서 ErrorBoundary로 비동기 통신 에러를 핸들링하고 싶다면 다음과 같은 방법도 있다.</p>
<div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">function</span> <span class="token function">MyComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>error<span class="token punctuation">,</span> setError<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> error<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>err <span class="token operator">=></span> <span class="token function">setError</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">...</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token punctuation">}</span></code></pre></div>
<p>비동기 에러 발생시에 컴포넌트 내부에서 Error를 throw 해 ErrorBoundary에서 캐치할 수 있도록 하는 것이다. 아마 React Query의 <code class="language-text">useErrorBoundary:true</code> 옵션을 사용하면 React Query 내부적으로 에러가 발생했을 때 에러를 throw 하도록 구현되어 있을 것이라 추측된다.</p>
<h2 id="에러바운더리를-사용함으로써-장점" style="position:relative;"><a href="#%EC%97%90%EB%9F%AC%EB%B0%94%EC%9A%B4%EB%8D%94%EB%A6%AC%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%A8%EC%9C%BC%EB%A1%9C%EC%8D%A8-%EC%9E%A5%EC%A0%90" aria-label="에러바운더리를 사용함으로써 장점 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>에러바운더리를 사용함으로써 장점</h2>
<p>React의 Error Boundary를 사용하면 발생한 에러를 적절히 격리시켜 애플리케이션의 전반적인 작동에 영향을 주지 않게끔 관리할 수 있다. 이를 통해 사용자에게는 문제가 발생한 부분 대신 대체 UI를 제공하고 대처 방법을 가이드함으로써 좋은 사용자 경험을 유지할 수 있다. 또한, 에러 바운더리에서 수집한 에러 정보를 활용해 에러 원인을 신속하게 파악하고 수정하는데 도움이 된다. 이러한 장점들은 전체적인 코드의 안정성과 신뢰성을 높일 수 있다.</p>
<p>뿐만 아니라 대수적 효과를 지원하는 코드를 작성할 수 있게 된다. 여기서 잠깐 <strong>대수적 효과</strong>에 대해 알아보자면</p>
<blockquote>
<p>💡 어떤 코드 조각을 감싸는 맥락으로 책임을 분리하는 방식을 대수적 효과라고 한다. 객체 지향의 의존성 주입, 의존성 역전과 유사하다고 볼 수 있다.</p>
</blockquote>
<br />
<div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token comment">// start loading    </span>
    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> apiClient<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">get</span><span class="token generic class-name"><span class="token operator">&lt;</span>User<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">URL</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> response
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// handle error  }</span>
<span class="token punctuation">}</span></code></pre></div>
<p>기존 코드의 경우, 매번 try-catch 문으로 감싸 주어야 한다는 불편함과 함께 성공하는 케이스와 실패하는 케이스의 코드가 함께 적혀있어 함수가 실제로 수행하고자 하는 동작이 가려지게 된다.</p>
<div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> apiClient<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">get</span><span class="token generic class-name"><span class="token operator">&lt;</span>User<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">URL</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> response
<span class="token punctuation">}</span></code></pre></div>
<p>ErrorBoundary를 사용하면 실패하는 경우의 동작은 에러 바운더리에 위임하고 데이터를 호출하는 함수는 위와 같이 순수하게 데이터만 가져오는 동작만 선언하여 사용할 수 있게 된다. Suspense를 사용하여 로딩 상태를 위임하는 것도 같은 대수적 효과로 볼 수 있다.</p>
<h2 id="나타날-수-있는-에러의-종류-분류하기" style="position:relative;"><a href="#%EB%82%98%ED%83%80%EB%82%A0-%EC%88%98-%EC%9E%88%EB%8A%94-%EC%97%90%EB%9F%AC%EC%9D%98-%EC%A2%85%EB%A5%98-%EB%B6%84%EB%A5%98%ED%95%98%EA%B8%B0" aria-label="나타날 수 있는 에러의 종류 분류하기 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>나타날 수 있는 에러의 종류 분류하기</h2>
<p>그렇다면 ErrorBoundary에서 처리해야 하는 에러의 종류는 어떤 것들이 있을까? 우선 크게 예측이 가능한 에러와 예측이 불가능한 에러로 나누어 생각해 본 뒤, 각 에러에 대해 유저에게 어떤 가이드를 제공할 수 있을지에 따라 크게 4 가지로 분류했다.</p>
<ul>
<li><strong>GET이 실패한 상황:</strong> data fetching에 실패하여 데이터 자체를 보여줄 수 없는 경우</li>
<li><strong>데이터 변경 HTTP 메서드가 실패한 상황:</strong> 사용자의 액션에 정상적으로 반응하지 못 하는 경우</li>
<li><strong>요청 권한이 없는 상황:</strong> 로그인이 끊겨 401 unauthorized 를 마주하는 경우</li>
<li><strong>unknown Error</strong>: 일시적인 네트워크 에러, 브라우저에서 발생하는 에러 등</li>
</ul>
<p>ErrorBoundary 내부에서 각 에러 타입에 적합한 대체 UI와 유저가 에러를 해결하기 위한 가이드를 제공하도록 로직을 작성할 것이다.</p>
<h2 id="에러-처리-전략" style="position:relative;"><a href="#%EC%97%90%EB%9F%AC-%EC%B2%98%EB%A6%AC-%EC%A0%84%EB%9E%B5" aria-label="에러 처리 전략 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>에러 처리 전략</h2>
<ul>
<li><strong>GET이 실패한 상황</strong>: 데이터 패칭에 실패하게 되면 현재 보여 줄 수 있는 데이터가 없거나 정확하지 않은 데이터를 노출하게 된다. 부정확한 데이터를 노출하는 것은 적절하지 않다고 생각하여 대체 UI를 보여주기로 했다. 또한 대체 UI에서 다시 시도하기 버튼을 노출해 유저가 에러 상황에서 데이터 패칭을 재시도 할 수 있도록 가이드한다. 추가적으로 토스트 메세지도 노출해 주도록 하자.</li>
<li><strong>데이터 변경 HTTP 메서드가 실패한 상황:</strong> POST, PUT, DELETE와 같은 변경 메서드는 사용자 액션에 의해 발생한다. 액션의 성공/실패 여부를 즉각 피드백 해줄 필요가 있다. 하지만, 액션이 실패했다고 하여 대체 UI를 보여줄 필요가 있을까? 사용자가 실패했다는 것을 인지하게 하고, 다시 요청하게끔 유도만 하면 될 것이다. 즉, 이 경우에는 토스트 UI만 발동시킨다.</li>
<li><strong>unauthorized(401) Error</strong>: 권한이 없어 발생하는 에러기 때문에 401 에러가 발생할 경우 로그인 페이지로 유도하려 했으나, 401 에러가 발생할 수 있는 케이스가 생각보다 다양하다는 것을 확인하고 무조건적으로 로그인 페이지로 유도하는 것은 적절하지 않다고 생각했다. (예를 들어 나의 서비스의 경우에는 비밀번호 변경 페이지에서 기존 비밀번호와 새로운 비밀번호를 적어 POST 했을 때 기존의 비밀번호가 일치하지 않으면 401을 리턴한다. 이 경우 갑자기 로그인 페이지로 유도한다면 유저는 상당히 당황스러운 경험을 하게 될 것이다 😅) 대신 토스트 메세지를 노출하여 유저가 문제를 인지하고 로그인 하거나 또는 하려던 액션을 재시도 할 수 있도록 가이드 했다.</li>
<li><strong>unknown Error</strong>: 해당 에러는 다양한 상황에 원인을 알 수 없는 에러임으로 토스트 메세지를 노출하고 대체 UI에서 메인 화면으로 이동할 수 있도록 가이드 한다.</li>
</ul>
<h2 id="globalerrorboundary-생성하기" style="position:relative;"><a href="#globalerrorboundary-%EC%83%9D%EC%84%B1%ED%95%98%EA%B8%B0" aria-label="globalerrorboundary 생성하기 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>GlobalErrorBoundary 생성하기</h2>
<p>위에서 정의한 모든 타입의 에러를 처리할 수 있는 <code class="language-text">GlobalErrorBoundary</code>를 생성할 것이다. <code class="language-text">GlobalErrorBoundary</code>는 이름에 걸맞게 app.tsx에서 pageComponent 전체를 감싸 Error의 최종 방어전선의 역할을 하도록 한다.</p>
<p>우선 에러의 타입을 정의해 준다.</p>
<div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">type</span> <span class="token class-name">GlobalErrorBoundaryState</span> <span class="token operator">=</span>
  <span class="token operator">|</span> <span class="token punctuation">{</span> error<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span> errorCase<span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span>
  <span class="token operator">|</span> <span class="token punctuation">{</span> error<span class="token operator">:</span> Error<span class="token punctuation">;</span> errorCase<span class="token operator">:</span> <span class="token string">'unknown'</span> <span class="token punctuation">}</span>
  <span class="token operator">|</span> <span class="token punctuation">{</span>
      error<span class="token operator">:</span> AxiosError
      errorCase<span class="token operator">:</span> <span class="token string">'unauthorized'</span> <span class="token operator">|</span> <span class="token string">'axiosGetError'</span> <span class="token operator">|</span> <span class="token string">'axiosMutationError'</span>
    <span class="token punctuation">}</span></code></pre></div>
<p>그리고 <code class="language-text">getDerivedStateFromError</code>에서 각 에러 타입을 state에 업데이트 한다.</p>
<div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token function">getDerivedStateFromError</span><span class="token punctuation">(</span>
    error<span class="token operator">:</span> Error
  <span class="token punctuation">)</span><span class="token operator">:</span> GlobalErrorBoundaryState <span class="token punctuation">{</span>
    <span class="token comment">// 다음 렌더링에서 폴백 UI가 보이도록 상태를 업데이트 한다.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> error<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span> errorCase<span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>error <span class="token keyword">instanceof</span> <span class="token class-name">AxiosError</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> error<span class="token punctuation">,</span> errorCase<span class="token operator">:</span> <span class="token string">'unknown'</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>response<span class="token operator">?.</span>status <span class="token operator">===</span> <span class="token number">401</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> error<span class="token punctuation">,</span> errorCase<span class="token operator">:</span> <span class="token string">'unauthorized'</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>response<span class="token operator">?.</span>config<span class="token punctuation">.</span>method <span class="token operator">===</span> <span class="token string">'get'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> error<span class="token punctuation">,</span> errorCase<span class="token operator">:</span> <span class="token string">'axiosGetError'</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span> error<span class="token punctuation">,</span> errorCase<span class="token operator">:</span> <span class="token string">'axiosMutationError'</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span></code></pre></div>
<p><code class="language-text">componentDidCatch</code>에서는 각 에러 타입에 따라 대체 UI 이외에 부가적으로 취할 액션을 정의해 준다. 나의 경우에는 AxiosError의 경우에는 서버에서 보내준 에러 문구를, unknown 에러의 경우에는 ‘알 수 없는 에러가 발생했습니다.’라는 문구를 토스트 메세지로 노출하도록 했다.</p>
<div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">public</span> <span class="token function">componentDidCatch</span><span class="token punctuation">(</span>error<span class="token operator">:</span> Error<span class="token punctuation">,</span> errorInfo<span class="token operator">:</span> ErrorInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 에러 리포팅 서비스에 에러를 기록할 수 있음</span>
    <span class="token comment">// logErrorToMyService(error, errorInfo)</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> error<span class="token operator">:</span> errorState<span class="token punctuation">,</span> errorCase <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state

    <span class="token keyword">if</span> <span class="token punctuation">(</span>errorState <span class="token keyword">instanceof</span> <span class="token class-name">AxiosError</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">errorMesssageHandler</span><span class="token punctuation">(</span>errorState<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>errorCase <span class="token operator">===</span> <span class="token string">'unknown'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> Toast<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token string">'알 수 없는 에러가 발생했습니다.'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'error'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span></code></pre></div>
<p>대체 UI의 경우에는 axiosGetError와 unknown 에러의 경우에만 노출하고, 나머지 에러의 경우에는 기존 페이지를 그대로 노출한다. 대체 UI는 renderFallback이란 Props로 받아와서 렌더링한다.</p>
<div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> error<span class="token punctuation">,</span> errorCase <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
    <span class="token keyword">const</span> <span class="token punctuation">{</span> children<span class="token punctuation">,</span> renderFallback <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props
    <span class="token keyword">const</span> renderFallbackErrorCases <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'axiosGetError'</span><span class="token punctuation">,</span> <span class="token string">'unknown'</span><span class="token punctuation">]</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>errorCase <span class="token operator">&amp;&amp;</span> renderFallbackErrorCases<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>errorCase<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">renderFallback</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        error<span class="token punctuation">,</span>
        errorCase<span class="token punctuation">,</span>
        onReset<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>resetErrorBoundary<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> children
  <span class="token punctuation">}</span></code></pre></div>
<h3 id="최종-완성-된-globalerrorboundary는-다음과-같다" style="position:relative;"><a href="#%EC%B5%9C%EC%A2%85-%EC%99%84%EC%84%B1-%EB%90%9C-globalerrorboundary%EB%8A%94-%EB%8B%A4%EC%9D%8C%EA%B3%BC-%EA%B0%99%EB%8B%A4" aria-label="최종 완성 된 globalerrorboundary는 다음과 같다 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>최종 완성 된 GlobalErrorBoundary는 다음과 같다</h3>
<div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">type</span> <span class="token class-name">GlobalErrorCase</span> <span class="token operator">=</span>
  <span class="token operator">|</span> <span class="token string">'unauthorized'</span>
  <span class="token operator">|</span> <span class="token string">'axiosGetError'</span>
  <span class="token operator">|</span> <span class="token string">'axiosMutationError'</span>
  <span class="token operator">|</span> <span class="token string">'unknown'</span>
<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">RenderFallbackProps<span class="token operator">&lt;</span>ErrorType <span class="token keyword">extends</span> Error <span class="token operator">=</span> Error<span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  error<span class="token operator">:</span> ErrorType
  errorCase<span class="token operator">:</span> GlobalErrorCase
  <span class="token function-variable function">onReset</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">unknown</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">RenderFallbackType</span> <span class="token operator">=</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ErrorType</span></span> <span class="token attr-name">extends</span> <span class="token attr-name">Error</span><span class="token punctuation">></span></span><span class="token plain-text">(
  props: RenderFallbackProps&lt;ErrorType>
) => ReactNode

type ErrorBoundaryProps = PropsWithRef&lt;
  PropsWithChildren&lt;</span><span class="token punctuation">{</span>
    onReset<span class="token operator">?</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
    renderFallback<span class="token operator">:</span> RenderFallbackType
  <span class="token punctuation">}</span><span class="token plain-text">>
>

type GlobalErrorBoundaryState =
  | </span><span class="token punctuation">{</span> error<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span> errorCase<span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span><span class="token plain-text">
  | </span><span class="token punctuation">{</span> error<span class="token operator">:</span> Error<span class="token punctuation">;</span> errorCase<span class="token operator">:</span> <span class="token string">'unknown'</span> <span class="token punctuation">}</span><span class="token plain-text">
  | </span><span class="token punctuation">{</span>
      error<span class="token operator">:</span> AxiosError<span class="token operator">&lt;</span><span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token operator">></span>
      errorCase<span class="token operator">:</span> <span class="token string">'unauthorized'</span> <span class="token operator">|</span> <span class="token string">'axiosGetError'</span> <span class="token operator">|</span> <span class="token string">'axiosMutationError'</span>
    <span class="token punctuation">}</span><span class="token plain-text">

const initialState: GlobalErrorBoundaryState = </span><span class="token punctuation">{</span>
  error<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  errorCase<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token plain-text">

export class GlobalErrorBoundary extends Component&lt;
  PropsWithChildren&lt;ErrorBoundaryProps>,
  GlobalErrorBoundaryState
> </span><span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token operator">:</span> ErrorBoundaryProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
      error<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      errorCase<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token function">getDerivedStateFromError</span><span class="token punctuation">(</span>
    error<span class="token operator">:</span> Error
  <span class="token punctuation">)</span><span class="token operator">:</span> GlobalErrorBoundaryState <span class="token punctuation">{</span>
    <span class="token comment">// 다음 렌더링에서 폴백 UI가 보이도록 상태를 업데이트 한다.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> error<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span> errorCase<span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>error <span class="token keyword">instanceof</span> <span class="token class-name">AxiosError</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> error<span class="token punctuation">,</span> errorCase<span class="token operator">:</span> <span class="token string">'unknown'</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>response<span class="token operator">?.</span>status <span class="token operator">===</span> <span class="token number">401</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> error<span class="token punctuation">,</span> errorCase<span class="token operator">:</span> <span class="token string">'unauthorized'</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>response<span class="token operator">?.</span>config<span class="token punctuation">.</span>method <span class="token operator">===</span> <span class="token string">'get'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> error<span class="token punctuation">,</span> errorCase<span class="token operator">:</span> <span class="token string">'axiosGetError'</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span> error<span class="token punctuation">,</span> errorCase<span class="token operator">:</span> <span class="token string">'axiosMutationError'</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// error fallback에 전달할 reset handler</span>
  <span class="token function-variable function">resetErrorBoundary</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> onReset <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props
    onReset <span class="token operator">&amp;&amp;</span> <span class="token function">onReset</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// ErrorBoundary state를 초기화</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span>initialState<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token function">componentDidCatch</span><span class="token punctuation">(</span>error<span class="token operator">:</span> Error<span class="token punctuation">,</span> errorInfo<span class="token operator">:</span> ErrorInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 에러 리포팅 서비스에 에러를 기록할 수 있음</span>
    <span class="token comment">// logErrorToMyService(error, errorInfo)</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> error<span class="token operator">:</span> errorState<span class="token punctuation">,</span> errorCase <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state

    <span class="token keyword">if</span> <span class="token punctuation">(</span>errorState <span class="token keyword">instanceof</span> <span class="token class-name">AxiosError</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">errorMesssageHandler</span><span class="token punctuation">(</span>errorState<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>errorCase <span class="token operator">===</span> <span class="token string">'unknown'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> Toast<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token string">'알 수 없는 에러가 발생했습니다.'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'error'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> error<span class="token punctuation">,</span> errorCase <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
    <span class="token keyword">const</span> <span class="token punctuation">{</span> children<span class="token punctuation">,</span> renderFallback <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props
    <span class="token keyword">const</span> renderFallbackErrorCases <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'axiosGetError'</span><span class="token punctuation">,</span> <span class="token string">'unknown'</span><span class="token punctuation">]</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>errorCase <span class="token operator">&amp;&amp;</span> renderFallbackErrorCases<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>errorCase<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">renderFallback</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        error<span class="token punctuation">,</span>
        errorCase<span class="token punctuation">,</span>
        onReset<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>resetErrorBoundary<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> children
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token plain-text">

export default GlobalErrorBoundary</span></code></pre></div>
<h2 id="localerrorboundary-생성하기" style="position:relative;"><a href="#localerrorboundary-%EC%83%9D%EC%84%B1%ED%95%98%EA%B8%B0" aria-label="localerrorboundary 생성하기 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>LocalErrorBoundary 생성하기</h2>
<p>추가적으로 LocalErrorBoundary를 생성해준다. 다음과 같은 상황을 고려한 것인데 네이버 화면을 예로 들어 설명하려고 한다.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/7dc0e1293e2b8245fd4b77664b312b9c/efe17/naver.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 57.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAAC1ElEQVQozz2S62scZRTG5//yg/4vfrIQWkQCtlqloNBUQbCbNJemJWpWWo2hoKmKNDYqqSu1u5psJ9tLdnZ3dnbn/s4713dmfzIb6YHD83DOgXN7tHObm1xp3uG9rSYXVta4sLzG+eUaV3nn5haLt748izVWWbh+g3PXVzi/ss5CY5XF9U0WN27z9q0vuNT8hkt3dtAc6XBw8As/790jCn2qsoBKUZv5tMPz1kMqlQMz1ByBMoeqqAnM1BnPk3lKG1sWG+s3uPbJEt0TnYFpEucZfWNK4+rHXLl8kdPhEF+EJHlOlqa4owGe7yEjQSwFUkb49oQsEmizooDZ7KxzlkGWUsYJaShQSQx1PkshTV6hcF2MoYkxGKCqGXFekKcpVZqi5aGP77pEYUAcRXMviwJVZJRFjsoKVJ5TFQVVWTITAbln4zg2WRwihcQPJJFtU8USTUWCiW1jTSboeo/xeIIx6GMObUanHoGfkNYTKEVRVajQJ+0/pwxclDul8hyyqUU2MqiiEC3zPX5tnfBw/4D331qgub7KzavvcnfzNj9+f59nL3sMhiYj02RkTZH2FN+yEEk6v1Kuyvo18w3LJEFLfZfDjs7pS4Ov1jbYu7fL3u42Pb3Lca+L67nIOCGSMaGMKUXAwBjTswISBZPplEAIxsMhql45nggO95+w/+An7n67RavVYWf7Pk+P27QP/8BxHZzAwbLHBDKiCDziMEbmM6KkoJQpZGU9KmUSo2Wez9fNJo3GZ3y4dJGd3e9447XXufbRB3z+6RKdow4nfZ0nL475s/svgTPFGQyQnk8uIrrTPr+bXR6bPVReoKWuTfvvv3im6/zT7jAy+hy1H9PrHtF69AgpAkzXpj+10A2DMhL0+wajsUUttuXhb7ypb3P5xQ8UqkLLI0ERCWZpMkcVR6SeQNohaeChZEQmQtIwoK7Nw4AwCOeyUUqB+l/DCqSM+Q/EbF3vAcQEswAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/7dc0e1293e2b8245fd4b77664b312b9c/8ac56/naver.webp 240w,
/static/7dc0e1293e2b8245fd4b77664b312b9c/d3be9/naver.webp 480w,
/static/7dc0e1293e2b8245fd4b77664b312b9c/e46b2/naver.webp 960w,
/static/7dc0e1293e2b8245fd4b77664b312b9c/f992d/naver.webp 1440w,
/static/7dc0e1293e2b8245fd4b77664b312b9c/882b9/naver.webp 1920w,
/static/7dc0e1293e2b8245fd4b77664b312b9c/a0179/naver.webp 2860w"
              sizes="(max-width: 960px) 100vw, 960px"
              type="image/webp"
            />
          <source
            srcset="/static/7dc0e1293e2b8245fd4b77664b312b9c/8ff5a/naver.png 240w,
/static/7dc0e1293e2b8245fd4b77664b312b9c/e85cb/naver.png 480w,
/static/7dc0e1293e2b8245fd4b77664b312b9c/d9199/naver.png 960w,
/static/7dc0e1293e2b8245fd4b77664b312b9c/07a9c/naver.png 1440w,
/static/7dc0e1293e2b8245fd4b77664b312b9c/29114/naver.png 1920w,
/static/7dc0e1293e2b8245fd4b77664b312b9c/efe17/naver.png 2860w"
            sizes="(max-width: 960px) 100vw, 960px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/7dc0e1293e2b8245fd4b77664b312b9c/d9199/naver.png"
            alt="naver.png"
            title="naver.png"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>한 화면 안에 날씨, 증시, 쇼핑 등 다양한 정보를 노출하고 있다. 만약 쇼핑과 날씨에 대한 정보는 제대로 받아왔지만 증시 데이터를 받아오는데 에러가 발생 했을 때 <code class="language-text">GlobalErrorBoundary</code> 만을 사용한다면 화면 전체에 대체 UI가 노출 될 것이다. 그러나 이러한 대처는 안좋은 유저경험을 제공하게 된다. 데이터를 잘 받아온 날씨와 쇼핑 부분은 화면은 정상적으로 노출하고 증시 부분에 대해서만 대체 UI를 제공함으로써 더 나은 UX를 제공할 수 있다.</p>
<p>따라서 이러한 에러의 경계선을 만들어 줄 수 있도록 <code class="language-text">LocalErrorBoundary</code>를 만들어 적용하고 싶은 부분에 따로 감싸 줄 수 있도록 한다.</p>
<div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">type</span> <span class="token class-name">LocalErrorBoundaryState</span> <span class="token operator">=</span>
  <span class="token operator">|</span> <span class="token punctuation">{</span> error<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span> errorCase<span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span>
  <span class="token operator">|</span> <span class="token punctuation">{</span> error<span class="token operator">:</span> Error<span class="token punctuation">;</span> errorCase<span class="token operator">:</span> <span class="token string">'shouldRethrow'</span> <span class="token punctuation">}</span>
  <span class="token operator">|</span> <span class="token punctuation">{</span> error<span class="token operator">:</span> Error<span class="token punctuation">;</span> errorCase<span class="token operator">:</span> <span class="token string">'unknown'</span> <span class="token punctuation">}</span>
  <span class="token operator">|</span> <span class="token punctuation">{</span>
      error<span class="token operator">:</span> AxiosError<span class="token operator">&lt;</span><span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token operator">></span>
      errorCase<span class="token operator">:</span> <span class="token string">'axiosGetError'</span>
    <span class="token punctuation">}</span></code></pre></div>
<p><code class="language-text">LocalErrorBoundary</code>에서는 unknown 에러와 axiosGetError 만을 캐치하고 나머지 에러는 throw하여 GlobalErrorBoundary에서 처리될 수 있도록 한다.</p>
<h3 id="완성된-localerrorboundary의-코드" style="position:relative;"><a href="#%EC%99%84%EC%84%B1%EB%90%9C-localerrorboundary%EC%9D%98-%EC%BD%94%EB%93%9C" aria-label="완성된 localerrorboundary의 코드 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>완성된 LocalErrorBoundary의 코드</h3>
<div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">type</span> <span class="token class-name">LocalErrorBoundaryProps<span class="token operator">&lt;</span>ErrorType <span class="token keyword">extends</span> Error <span class="token operator">=</span> Error<span class="token operator">></span></span> <span class="token operator">=</span> PropsWithRef<span class="token operator">&lt;</span>
  PropsWithChildren<span class="token operator">&lt;</span><span class="token punctuation">{</span>
    <span class="token comment">/**
     * @description 발생할 수 있는 error에 대한 기준값으로 이 값이 변경되면 error를 초기화한다.
     */</span>
    resetKeys<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">unknown</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    onReset<span class="token operator">?</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
    renderFallback<span class="token operator">:</span> RenderFallbackType
    onError<span class="token operator">?</span><span class="token punctuation">(</span>error<span class="token operator">:</span> ErrorType<span class="token punctuation">,</span> info<span class="token operator">:</span> ErrorInfo<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
  <span class="token punctuation">}</span><span class="token operator">></span>
<span class="token operator">></span>

<span class="token keyword">type</span> <span class="token class-name">LocalErrorBoundaryState</span> <span class="token operator">=</span>
  <span class="token operator">|</span> <span class="token punctuation">{</span> error<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span> errorCase<span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span>
  <span class="token operator">|</span> <span class="token punctuation">{</span> error<span class="token operator">:</span> Error<span class="token punctuation">;</span> errorCase<span class="token operator">:</span> <span class="token string">'shouldRethrow'</span> <span class="token punctuation">}</span>
  <span class="token operator">|</span> <span class="token punctuation">{</span> error<span class="token operator">:</span> Error<span class="token punctuation">;</span> errorCase<span class="token operator">:</span> <span class="token string">'unknown'</span> <span class="token punctuation">}</span>
  <span class="token operator">|</span> <span class="token punctuation">{</span>
      error<span class="token operator">:</span> AxiosError<span class="token operator">&lt;</span><span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token operator">></span>
      errorCase<span class="token operator">:</span> <span class="token string">'axiosGetError'</span>
    <span class="token punctuation">}</span>

<span class="token keyword">const</span> initialState<span class="token operator">:</span> LocalErrorBoundaryState <span class="token operator">=</span> <span class="token punctuation">{</span>
  error<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  errorCase<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">BaseErrorBoundary</span> <span class="token keyword">extends</span> <span class="token class-name">Component<span class="token operator">&lt;</span>
  PropsWithChildren<span class="token operator">&lt;</span>LocalErrorBoundaryProps<span class="token operator">></span><span class="token punctuation">,</span>
  LocalErrorBoundaryState
<span class="token operator">></span></span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> initialState

  updatedWithError <span class="token operator">=</span> <span class="token boolean">false</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token operator">:</span> LocalErrorBoundaryProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
      error<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      errorCase<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token function">getDerivedStateFromError</span><span class="token punctuation">(</span>
    error<span class="token operator">:</span> Error
  <span class="token punctuation">)</span><span class="token operator">:</span> LocalErrorBoundaryState <span class="token punctuation">{</span>
    <span class="token comment">// 다음 렌더링에서 폴백 UI가 보이도록 상태를 업데이트 한다.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> error<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span> errorCase<span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>error <span class="token keyword">instanceof</span> <span class="token class-name">AxiosError</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> error<span class="token punctuation">,</span> errorCase<span class="token operator">:</span> <span class="token string">'unknown'</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>response<span class="token operator">?.</span>config<span class="token punctuation">.</span>method <span class="token operator">===</span> <span class="token string">'get'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> error<span class="token punctuation">,</span> errorCase<span class="token operator">:</span> <span class="token string">'axiosGetError'</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span> error<span class="token punctuation">,</span> errorCase<span class="token operator">:</span> <span class="token string">'shouldRethrow'</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">resetState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>updatedWithError <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span>initialState<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// error fallback에 전달할 reset handler</span>
  <span class="token function-variable function">resetErrorBoundary</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> onReset <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props
    onReset <span class="token operator">&amp;&amp;</span> <span class="token function">onReset</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// ErrorBoundary state를 초기화</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">resetState</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token function">componentDidCatch</span><span class="token punctuation">(</span>error<span class="token operator">:</span> Error<span class="token punctuation">,</span> errorInfo<span class="token operator">:</span> ErrorInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 에러 리포팅 서비스에 에러를 기록할 수 있음</span>
    <span class="token comment">// logErrorToMyService(error, errorInfo)</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> error<span class="token operator">:</span> errorState<span class="token punctuation">,</span> errorCase <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
    <span class="token keyword">const</span> <span class="token punctuation">{</span> onError <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props

    <span class="token keyword">if</span> <span class="token punctuation">(</span>errorCase <span class="token operator">===</span> <span class="token string">'axiosGetError'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      onError <span class="token operator">&amp;&amp;</span> <span class="token function">onError</span><span class="token punctuation">(</span>error<span class="token punctuation">,</span> errorInfo<span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token function">errorMesssageHandler</span><span class="token punctuation">(</span>errorState<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>errorCase <span class="token operator">===</span> <span class="token string">'unknown'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      onError <span class="token operator">&amp;&amp;</span> <span class="token function">onError</span><span class="token punctuation">(</span>error<span class="token punctuation">,</span> errorInfo<span class="token punctuation">)</span>
      <span class="token keyword">return</span> Toast<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token string">'알 수 없는 에러가 발생했습니다.'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'error'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>errorCase <span class="token operator">===</span> <span class="token string">'shouldRethrow'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> error
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span>prevProps<span class="token operator">:</span> LocalErrorBoundaryProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> error <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
    <span class="token keyword">const</span> <span class="token punctuation">{</span> resetKeys <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props

    <span class="token keyword">if</span> <span class="token punctuation">(</span>error <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>updatedWithError<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>updatedWithError <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isDifferentArray</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">.</span>resetKeys<span class="token punctuation">,</span> resetKeys<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">resetErrorBoundary</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> error<span class="token punctuation">,</span> errorCase <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
    <span class="token keyword">const</span> <span class="token punctuation">{</span> children<span class="token punctuation">,</span> renderFallback <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props

    <span class="token keyword">if</span> <span class="token punctuation">(</span>error <span class="token operator">&amp;&amp;</span> errorCase <span class="token operator">!==</span> <span class="token string">'shouldRethrow'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">renderFallback</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        error<span class="token punctuation">,</span>
        errorCase<span class="token punctuation">,</span>
        onReset<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>resetErrorBoundary<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> children
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> LocalErrorBoundary <span class="token operator">=</span> <span class="token generic-function"><span class="token function">forwardRef</span><span class="token generic class-name"><span class="token operator">&lt;</span>
  <span class="token punctuation">{</span> <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  ComponentPropsWithoutRef<span class="token operator">&lt;</span><span class="token keyword">typeof</span> BaseErrorBoundary<span class="token operator">></span>
<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> resetRef<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> ref <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useRef</span><span class="token generic class-name"><span class="token operator">&lt;</span>BaseErrorBoundary<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>

  <span class="token function">useImperativeHandle</span><span class="token punctuation">(</span>resetRef<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">reset</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> ref<span class="token punctuation">.</span>current<span class="token operator">?.</span><span class="token function">resetErrorBoundary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">BaseErrorBoundary</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span></span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>ref<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

LocalErrorBoundary<span class="token punctuation">.</span>displayName <span class="token operator">=</span> <span class="token string">'LocalErrorBoundary'</span></code></pre></div>
<p>추가적으로 LocalErrorBoundary에서는 옵셔널하게 onError와 resetKeys라는 Props를 받을 수 있도록 하여 onError를 통해 에러 발생시에 취하고 싶은 추가적인 엑션을 설정하거나, resetKeys가 변경되면 에러가 리셋될 수 있도록 했다.
<br /></p>
<p><strong>실제 서비스에 적용된다면 어떤 모습일까?</strong></p>
<p>서비스의 메뉴 목록 중에는 아래의 이미지에서 보여지듯 유저의 마일리지를 실시간으로 노출해주는 항목이 있다. 만약 어떠한 이유로 인해 마일리지를 값을 받아오는 API 통신에서 에러가 발생 했을 때 메뉴 전체가 대체UI로 노출된다면 유저는 어디로도 이동할 수 없는 진퇴양난의 상황에 빠지게 될 수도 있다😫. 하지만 이러한 경우에 에러가 발생할 수 있는 컴포넌트만 LocalErrorBoundary로 감싸준다면? 짜잔- 오른쪽의 화면처럼 에러가 발생한 마일리지 메뉴 항목만 대체 UI를 노출할 수 있다.
<br /></p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 850px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/330bcfc3bfca680766f8a15b413ed5fd/ae694/localErrorBoundary.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 89.16666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAABYlAAAWJQFJUiTwAAADb0lEQVQ4y4WUXUybVRjHX8fXhKAUMHNeOGOyqZSWQcO0jYnJvCC6oVcmM7C1ZYIaLzAkCIJZvNVwo0EvySThI0u4MS5kL0sLIdGW3kCyS5dRa7H0g9IW+vm+/ZlzulZE1Cf55z3nvM/5n+c8z/85iu2NN3n73fdIHRxQtiJQ0DSJTDaHrut8cetL2ju6+cWzwXErFosSuVwOpfOVl+m5fJn9/X2Wl5f5ze8nvLsrSYRpWkF+Rz8d5vy5c2x4PGz4fPh8PmKxKNlsWv4X/vl8HqX7hee4YusmGomwtbVFPB7n8PAQTdc5TOukMyXC8U8+pK31KTzra+yGwzx8+CvB4B/s7ITI51KVSJXu55/hqrWT3wMB9hMJuVi27aBOOJYvEX78AW2G0/y86pbzBw+gpyeD1Zrg228EoUY+r6N0nTXQYzERDocldnZ2ZOgcIRb22dAAFxprWL+/QhGd7e04q6vg80Eo9JefcraxnkuWLhYX5rDb7YyNjTM6OsrIyAjXr9+gr68Pv9/P8NAgp08pLC4ssLS0xJ07i7hcP7K29hN37y5x+/YPbG5uojTU1dFlNqGqKl99PcXs7Czz8/PMzc0xPT3N1NQU0WgUp91O7akn+P67aewOB/39Nxga+oibN4e4du19bDYrMzMzKIYGAxdfMssq/5fZ+x3UK3XcW1ZJJpOycEImAoVCXn5llZufPkNnu4VIJCIXRPk1Tasgm81KQqdjkPrqRtR7K2i6duKhYq9iMJzBYjSxF4uSTKZIp9N/E2uhUJKN0znIk1V1rK6oUvCpVKriI1AORGlpbsJiNBIJh0kkk3LxKGFZ4AMDThqqq3CpKrl8nkQiIXuqLLOyr9Lc3ISp3SjzcpToOKHT6aC2ppoVVZWiP35wqWERV27CaGyTSf4/wprqKtxu1+OW1P7hKzultbWFjg4zB48fB0FwEqG4cm1tDW53qVNEbk8ktFpf453e3kqEJ70kwiYmJjCZTHi9nn+VliS02Wxc7e2V1RUSEbnMZDJHNFaq8uTkJGZzB16vV86FboW/kJpAOWLlxQuvct70liQRCAaDhEIh9vb2JGRfA8Mjn1Pb2IZrrRTho0fbBAIB2UUC5RsqF7te55LtCrFYTJ4oni8xFmRiLHJbLOqMjd+i5VkT913rcmM8vl8hE76CUOz/EzWIo+eCOgOgAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <picture>
          <source
              srcset="/static/330bcfc3bfca680766f8a15b413ed5fd/8ac56/localErrorBoundary.webp 240w,
/static/330bcfc3bfca680766f8a15b413ed5fd/d3be9/localErrorBoundary.webp 480w,
/static/330bcfc3bfca680766f8a15b413ed5fd/10237/localErrorBoundary.webp 850w"
              sizes="(max-width: 850px) 100vw, 850px"
              type="image/webp"
            />
          <source
            srcset="/static/330bcfc3bfca680766f8a15b413ed5fd/8ff5a/localErrorBoundary.png 240w,
/static/330bcfc3bfca680766f8a15b413ed5fd/e85cb/localErrorBoundary.png 480w,
/static/330bcfc3bfca680766f8a15b413ed5fd/ae694/localErrorBoundary.png 850w"
            sizes="(max-width: 850px) 100vw, 850px"
            type="image/png"
          />
          <img
            class="gatsby-resp-image-image"
            src="/static/330bcfc3bfca680766f8a15b413ed5fd/ae694/localErrorBoundary.png"
            alt="localErrorBoundary"
            title="localErrorBoundary"
            loading="lazy"
            decoding="async"
            style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
          />
        </picture>
  </a>
    </span></p>
<p>이제 서버와 통신하는 비동기 코드를 일일히 try-catch로 감싸는 수고로움 없이 우아하게 에러를 다룰 수 있게 되었다.</p>
<p>사실 조금만 찾아보면 여러가지 편의 기능을 제공하는 ErrorBoundary 라이브러리들이 존재한다. <a href="https://www.npmjs.com/package/react-error-boundary" target="_blank" rel="nofollow noopener noreferrer">react-error-boundary</a>도 있고, 토스에서 제공하는 라이브러리인 toss/slash에도 <a href="https://slash.page/ko/libraries/react/error-boundary/src/ErrorBoundary.i18n" target="_blank" rel="nofollow noopener noreferrer">@toss/error-boundary</a>가 있다. 내가 작성한 <code class="language-text">ErrorBoundary</code>도 해당 라이브러리들의 코드를 많이 참고했다. 라이브러리를 설치해 사용하면 보다 손쉽게 사용이 가능하지만 라이브러리의 코드를 뜯어보고 직접 만들어 사용해보면 내부동작을 이해하고 사용할 수 있어 공부가 되기도 하고 각자의 서비스에 맞게 커스텀이 가능하니, 이 글을 읽는 누군가도 가능한 라이브러리의 코드는 참고용으로 보고 직접 만들어보길 권장해본다😋
<br />
<br /></p>
<h4 id="참고자료" style="position:relative;"><a href="#%EC%B0%B8%EA%B3%A0%EC%9E%90%EB%A3%8C" aria-label="참고자료 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>참고자료</h4>
<ul>
<li><a href="https://jbee.io/react/error-declarative-handling-0/" target="_blank" rel="nofollow noopener noreferrer">효율적인 프론트엔드 에러핸들링</a></li>
<li><a href="https://jeongyunlog.netlify.app/develop/react/react-error-boundary/" target="_blank" rel="nofollow noopener noreferrer">React ErrorBoundary를 통한 선언적 에러처리</a></li>
<li><a href="https://happysisyphe.tistory.com/52" target="_blank" rel="nofollow noopener noreferrer">ErrorBoundary로 Toast, ErrorFallback 등 공통적인 에러를 처리해보자</a></li>
<li><a href="https://fe-developers.kakaoent.com/2022/221110-error-boundary/" target="_blank" rel="nofollow noopener noreferrer">React의 Error Boundary를 이용하여 효과적으로 에러 처리하기</a></li>
</ul></div></div></div><div class="Post-module--footer--f8705"><div class="Meta-module--meta--dae0a"><p class="Meta-module--date--4d30d">Published<!-- --> <!-- -->Jun 24, 2023</p></div><div class="Author-module--author--1c58d"><p class="Author-module--bio--08950">유연하고 견고하게</p></div></div><div class="Post-module--comments--d3b99"></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/posts/Handling-errors-gracefully-with-ErrorBoundary";window.___webpackCompilationHash="ea9094bddc47dd5414d2";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-e1c32d6a7a750413c7a4.js"],"app":["/app-6fa3fbf1dd3150d69b24.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-0c915c7b1bdb5eac4fdf.js"],"component---src-templates-categories-template-categories-template-tsx":["/component---src-templates-categories-template-categories-template-tsx-62f405ff2abef42a6822.js"],"component---src-templates-category-template-category-template-tsx":["/component---src-templates-category-template-category-template-tsx-0c89de6e9e37da734767.js"],"component---src-templates-index-template-index-template-tsx":["/component---src-templates-index-template-index-template-tsx-810275573d33fa910098.js"],"component---src-templates-not-found-template-not-found-template-tsx":["/component---src-templates-not-found-template-not-found-template-tsx-dc5e75a9ef77294c4bdd.js"],"component---src-templates-page-template-page-template-tsx":["/component---src-templates-page-template-page-template-tsx-df3777de50aa905fe2d2.js"],"component---src-templates-post-template-post-template-tsx":["/component---src-templates-post-template-post-template-tsx-dbf5a97a135de9fb3c1f.js"],"component---src-templates-tag-template-tag-template-tsx":["/component---src-templates-tag-template-tag-template-tsx-c8056fb6aee070306f99.js"],"component---src-templates-tags-template-tags-template-tsx":["/component---src-templates-tags-template-tags-template-tsx-82547f0328b8bf767e2b.js"]};/*]]>*/</script><script src="/polyfill-e1c32d6a7a750413c7a4.js" nomodule=""></script><script src="/app-6fa3fbf1dd3150d69b24.js" async=""></script><script src="/framework-481a1b6416c14416b2fb.js" async=""></script><script src="/webpack-runtime-e7d2f6c06f6d684f4d5b.js" async=""></script></body></html>